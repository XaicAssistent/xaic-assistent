"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var calendarModule = require("nativescript-ui-calendar");
var Event_1 = require("../model/Event");
var Perido_1 = require("../model/Perido");
var color_1 = require("tns-core-modules/color/color");
var EventMapper = /** @class */ (function () {
    function EventMapper() {
    }
    EventMapper.eventstoCalendarEvent = function (events) {
        var eventsCalendar = [];
        var colors = [new color_1.Color(200, 188, 26, 214), new color_1.Color(220, 255, 109, 130), new color_1.Color(255, 55, 45, 255), new color_1.Color(199, 17, 227, 10), new color_1.Color(255, 255, 54, 3)];
        events.forEach(function (evento) {
            var startDate;
            var endDate;
            startDate = new Date(evento.fecha.getFullYear(), evento.fecha.getMonth(), evento.fecha.getDate());
            startDate.setHours(evento.periodo.empiezaHora);
            startDate.setMinutes(evento.periodo.empiezaMinuto);
            endDate = new Date(evento.fecha.getFullYear(), evento.fecha.getMonth(), evento.fecha.getDate());
            endDate.setHours(evento.periodo.acabaHora);
            endDate.setMinutes(evento.periodo.acabaMinuto);
            var event = new calendarModule.CalendarEvent(evento.titulo, startDate, endDate, false, colors[Math.floor(Math.random() * (colors.length - 0 + 1)) + 0]);
            eventsCalendar.push(event);
        });
        return eventsCalendar;
    };
    EventMapper.eventsJSONtoEvent = function (eventsJSON) {
        var events = [];
        eventsJSON["events"].forEach(function (eve) {
            //faltara posar els users
            var evento = new Event_1.Event();
            evento.idEvento = eve.IdEvento;
            evento.titulo = eve.Titulo;
            evento.descripcion = eve.Descripcion;
            var fechaSpliteada = eve.Fecha.split("T", 1)[0].split("-", 3);
            var fecha = new Date(fechaSpliteada[0], fechaSpliteada[1] - 1, fechaSpliteada[2]);
            evento.fecha = fecha;
            var periodo = new Perido_1.Periodo();
            var horasMinutosEmpieza = eve.Empieza.split("T", 2)[1].split(":", 2);
            var horasMinutosAcaba = eve.Acaba.split("T", 2)[1].split(":", 2);
            periodo.empiezaHora = horasMinutosEmpieza[0];
            periodo.empiezaMinuto = horasMinutosEmpieza[1];
            periodo.acabaHora = horasMinutosAcaba[0];
            periodo.acabaMinuto = horasMinutosAcaba[1];
            evento.periodo = periodo;
            evento.motivoCancelacion = eve.MotivoCancelacion;
            evento.estado.idEstado = eve.Estado;
            if (eve.IdUserEmpresa) {
                evento.userEmpresa.idUserEmprea = eve.IdUserEmpresa;
            }
            events.push(evento);
        });
        return events;
    };
    EventMapper.infoEventJSONtoEvent = function (infoEventJSON) {
        var evento = new Event_1.Event();
        var eve = infoEventJSON['evento'];
        evento.idEvento = eve.IdEvento;
        evento.titulo = eve.Titulo;
        evento.descripcion = eve.Descripcion;
        var fechaSpliteada = eve.Fecha.split("T", 1)[0].split("-", 3);
        var fecha = new Date(fechaSpliteada[0], fechaSpliteada[1] - 1, fechaSpliteada[2]);
        evento.fecha = fecha;
        var periodo = new Perido_1.Periodo();
        var horasMinutosEmpieza = eve.Empieza.split("T", 2)[1].split(":", 2);
        var horasMinutosAcaba = eve.Acaba.split("T", 2)[1].split(":", 2);
        periodo.empiezaHora = horasMinutosEmpieza[0];
        periodo.empiezaMinuto = horasMinutosEmpieza[1];
        periodo.acabaHora = horasMinutosAcaba[0];
        periodo.acabaMinuto = horasMinutosAcaba[1];
        evento.periodo = periodo;
        evento.motivoCancelacion = eve.MotivoCancelacion;
        evento.estado.idEstado = infoEventJSON['estado'].IdEstado;
        evento.estado.codigo = infoEventJSON['estado'].Codigo;
        evento.estado.descripcion = infoEventJSON['estado'].Descripcion;
        if (infoEventJSON['userEmpresa']) {
            var user = infoEventJSON['userEmpresa'];
            evento.userEmpresa.idUserEmprea = user["UserEmpresa.IdUserEmpresa"];
            evento.userEmpresa.idUser = user.IdUser;
            evento.userEmpresa.nombre = user.Nombre;
            evento.userEmpresa.apellidos = user.Apellidos;
            evento.userEmpresa.telefono = user.Telefono;
            evento.userEmpresa.apellidos = user.Apellidos;
            evento.userEmpresa.foto = user.Foto;
            evento.userEmpresa.category.nombre = user["Category.nombre"];
            evento.userEmpresa.direccionFija = user["UserEmpresa.drireccion_fija"];
        }
        evento.location = eve.Direccion;
        return evento;
    };
    return EventMapper;
}());
exports.EventMapper = EventMapper;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiRXZlbnRNYXBwZXIuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlcyI6WyJFdmVudE1hcHBlci50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOztBQUFBLHlEQUEyRDtBQUMzRCx3Q0FBdUM7QUFDdkMsMENBQTBDO0FBQzFDLHNEQUFxRDtBQUVyRDtJQUFBO0lBcUhBLENBQUM7SUFwSGlCLGlDQUFxQixHQUFuQyxVQUFvQyxNQUFlO1FBQy9DLElBQUksY0FBYyxHQUFHLEVBQUUsQ0FBQztRQUN4QixJQUFJLE1BQU0sR0FBRyxDQUFDLElBQUksYUFBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLEdBQUcsQ0FBQyxFQUFFLElBQUksYUFBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsR0FBRyxFQUFFLEdBQUcsQ0FBQyxFQUFFLElBQUksYUFBSyxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsRUFBRSxFQUFFLEdBQUcsQ0FBQyxFQUFFLElBQUksYUFBSyxDQUFDLEdBQUcsRUFBRSxFQUFFLEVBQUUsR0FBRyxFQUFFLEVBQUUsQ0FBQyxFQUFFLElBQUksYUFBSyxDQUFDLEdBQUcsRUFBRSxHQUFHLEVBQUUsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLENBQUM7UUFFakssTUFBTSxDQUFDLE9BQU8sQ0FBQyxVQUFBLE1BQU07WUFDakIsSUFBSSxTQUFlLENBQUM7WUFDcEIsSUFBSSxPQUFhLENBQUM7WUFFbEIsU0FBUyxHQUFHLElBQUksSUFBSSxDQUFDLE1BQU0sQ0FBQyxLQUFLLENBQUMsV0FBVyxFQUFFLEVBQUUsTUFBTSxDQUFDLEtBQUssQ0FBQyxRQUFRLEVBQUUsRUFBRSxNQUFNLENBQUMsS0FBSyxDQUFDLE9BQU8sRUFBRSxDQUFDLENBQUM7WUFDbEcsU0FBUyxDQUFDLFFBQVEsQ0FBQyxNQUFNLENBQUMsT0FBTyxDQUFDLFdBQVcsQ0FBQyxDQUFDO1lBQy9DLFNBQVMsQ0FBQyxVQUFVLENBQUMsTUFBTSxDQUFDLE9BQU8sQ0FBQyxh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QUMsTUFBTSxHQUFHLElBQUksQ0FBQyxNQUFNLENBQUM7WUFDeEMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLEdBQUcsSUFBSSxDQUFDLFNBQVMsQ0FBQztZQUM5QyxNQUFNLENBQUMsV0FBVyxDQUFDLFFBQVEsR0FBRyxJQUFJLENBQUMsUUFBUSxDQUFDO1lBQzVDLE1BQU0sQ0FBQyxXQUFXLENBQUMsU0FBUyxHQUFHLElBQUksQ0FBQyxTQUFTLENBQUM7WUFDOUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxJQUFJLEdBQUcsSUFBSSxDQUFDLElBQUksQ0FBQztZQUNwQyxNQUFNLENBQUMsV0FBVyxDQUFDLFFBQVEsQ0FBQyxNQUFNLEdBQUcsSUFBSSxDQUFDLGlCQUFpQixDQUFDLENBQUM7WUFDN0QsTUFBTSxDQUFDLFdBQVcsQ0FBQyxhQUFhLEdBQVksSUFBSSxDQUFDLDZCQUE2QixDQUFDLENBQUM7U0FDbkY7UUFFRCxNQUFNLENBQUMsUUFBUSxHQUFHLEdBQUcsQ0FBQyxTQUFTLENBQUM7UUFFaEMsT0FBTyxNQUFNLENBQUM7SUFDbEIsQ0FBQztJQUNMLGtCQUFDO0FBQUQsQ0FBQyxBQXJIRCxJQXFIQztBQXJIWSxrQ0FBVyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAqIGFzIGNhbGVuZGFyTW9kdWxlIGZyb20gXCJuYXRpdmVzY3JpcHQtdWktY2FsZW5kYXJcIjtcbmltcG9ydCB7IEV2ZW50IH0gZnJvbSBcIi4uL21vZGVsL0V2ZW50XCI7XG5pbXBvcnQgeyBQZXJpb2RvIH0gZnJvbSBcIi4uL21vZGVsL1Blcmlkb1wiO1xuaW1wb3J0IHsgQ29sb3IgfSBmcm9tIFwidG5zLWNvcmUtbW9kdWxlcy9jb2xvci9jb2xvclwiO1xuXG5leHBvcnQgY2xhc3MgRXZlbnRNYXBwZXIge1xuICAgIHB1YmxpYyBzdGF0aWMgZXZlbnRzdG9DYWxlbmRhckV2ZW50KGV2ZW50czogRXZlbnRbXSkgOiBjYWxlbmRhck1vZHVsZS5DYWxlbmRhckV2ZW50W117XG4gICAgICAgIGxldCBldmVudHNDYWxlbmRhciA9IFtdO1xuICAgICAgICBsZXQgY29sb3JzID0gW25ldyBDb2xvcigyMDAsIDE4OCwgMjYsIDIxNCksIG5ldyBDb2xvcigyMjAsIDI1NSwgMTA5LCAxMzApLCBuZXcgQ29sb3IoMjU1LCA1NSwgNDUsIDI1NSksIG5ldyBDb2xvcigxOTksIDE3LCAyMjcsIDEwKSwgbmV3IENvbG9yKDI1NSwgMjU1LCA1NCwgMyldO1xuXG4gICAgICAgIGV2ZW50cy5mb3JFYWNoKGV2ZW50byA9PiB7XG4gICAgICAgICAgICBsZXQgc3RhcnREYXRlOiBEYXRlO1xuICAgICAgICAgICAgbGV0IGVuZERhdGU6IERhdGU7XG5cbiAgICAgICAgICAgIHN0YXJ0RGF0ZSA9IG5ldyBEYXRlKGV2ZW50by5mZWNoYS5nZXRGdWxsWWVhcigpLCBldmVudG8uZmVjaGEuZ2V0TW9udGgoKSwgZXZlbnRvLmZlY2hhLmdldERhdGUoKSk7XG4gICAgICAgICAgICBzdGFydERhdGUuc2V0SG91cnMoZXZlbnRvLnBlcmlvZG8uZW1waWV6YUhvcmEpO1xuICAgICAgICAgICAgc3RhcnREYXRlLnNldE1pbnV0ZXMoZXZlbnRvLnBlcmlvZG8uZW1waWV6YU1pbnV0byk7XG5cbiAgICAgICAgICAgIGVuZERhdGUgPSBuZXcgRGF0ZShldmVudG8uZmVjaGEuZ2V0RnVsbFllYXIoKSwgZXZlbnRvLmZlY2hhLmdldE1vbnRoKCksIGV2ZW50by5mZWNoYS5nZXREYXRlKCkpO1xuICAgICAgICAgICAgZW5kRGF0ZS5zZXRIb3VycyhldmVudG8ucGVyaW9kby5hY2FiYUhvcmEpO1xuICAgICAgICAgICAgZW5kRGF0ZS5zZXRNaW51dGVzKGV2ZW50by5wZXJpb2RvLmFjYWJhTWludXRvKTtcblxuICAgICAgICAgICAgbGV0IGV2ZW50ID0gbmV3IGNhbGVuZGFyTW9kdWxlLkNhbGVuZGFyRXZlbnQoZXZlbnRvLnRpdHVsbywgc3RhcnREYXRlLCBlbmREYXRlLCBmYWxzZSwgY29sb3JzW01hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIChjb2xvcnMubGVuZ3RoIC0gMCArIDEpKSArIDBdKTtcblxuICAgICAgICAgICAgZXZlbnRzQ2FsZW5kYXIucHVzaChldmVudCk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBldmVudHNDYWxlbmRhcjtcbiAgICB9XG5cbiAgICBwdWJsaWMgc3RhdGljIGV2ZW50c0pTT050b0V2ZW50KGV2ZW50c0pTT04pIDogRXZlbnRbXXtcbiAgICAgICAgbGV0IGV2ZW50czogRXZlbnRbXSA9IFtdO1xuXG4gICAgICAgIGV2ZW50c0pTT05bXCJldmVudHNcIl0uZm9yRWFjaCgoZXZlKSA9PiB7XG4gICAgICAgICAgICAvL2ZhbHRhcmEgcG9zYXIgZWxzIHVzZXJzXG4gICAgICAgICAgICBsZXQgZXZlbnRvOiBFdmVudCA9IG5ldyBFdmVudCgpO1xuICAgICAgICAgICAgZXZlbnRvLmlkRXZlbnRvID0gZXZlLklkRXZlbnRvO1xuICAgICAgICAgICAgZXZlbnRvLnRpdHVsbyA9IGV2ZS5UaXR1bG87XG4gICAgICAgICAgICBldmVudG8uZGVzY3JpcGNpb24gPSBldmUuRGVzY3JpcGNpb247XG5cbiAgICAgICAgICAgIGxldCBmZWNoYVNwbGl0ZWFkYSA9IGV2ZS5GZWNoYS5zcGxpdChcIlRcIiwgMSlbMF0uc3BsaXQoXCItXCIsIDMpO1xuICAgICAgICAgICAgbGV0IGZlY2hhOiBEYXRlID0gIG5ldyBEYXRlKGZlY2hhU3BsaXRlYWRhWzBdLCBmZWNoYVNwbGl0ZWFkYVsxXSAtIDEsIGZlY2hhU3BsaXRlYWRhWzJdKTtcblxuICAgICAgICAgICAgZXZlbnRvLmZlY2hhID0gZmVjaGE7XG5cbiAgICAgICAgICAgIGxldCBwZXJpb2RvOlBlcmlvZG8gPSBuZXcgUGVyaW9kbygpO1xuICAgICAgICAgICAgXG4gICAgICAgICAgICBsZXQgaG9yYXNNaW51dG9zRW1waWV6YSA9IGV2ZS5FbXBpZXphLnNwbGl0KFwiVFwiLCAyKVsxXS5zcGxpdChcIjpcIiwgMik7XG4gICAgICAgICAgICBsZXQgaG9yYXNNaW51dG9zQWNhYmEgPSBldmUuQWNhYmEuc3BsaXQoXCJUXCIsIDIpWzFdLnNwbGl0KFwiOlwiLCAyKTtcblxuICAgICAgICAgICAgcGVyaW9kby5lbXBpZXphSG9yYSA9IGhvcmFzTWludXRvc0VtcGllemFbMF07XG4gICAgICAgICAgICBwZXJpb2RvLmVtcGllemFNaW51dG8gPSBob3Jhc01pbnV0b3NFbXBpZXphWzFdO1xuXG4gICAgICAgICAgICBwZXJpb2RvLmFjYWJhSG9yYSA9IGhvcmFzTWludXRvc0FjYWJhWzBdO1xuICAgICAgICAgICAgcGVyaW9kby5hY2FiYU1pbnV0byA9IGhvcmFzTWludXRvc0FjYWJhWzFdO1xuXG4gICAgICAgICAgICBldmVudG8ucGVyaW9kbyA9IHBlcmlvZG87XG5cbiAgICAgICAgICAgIGV2ZW50by5tb3Rpdm9DYW5jZWxhY2lvbiA9IGV2ZS5Nb3Rpdm9DYW5jZWxhY2lvbjtcblxuICAgICAgICAgICAgZXZlbnRvLmVzdGFkby5pZEVzdGFkbyA9IGV2ZS5Fc3RhZG87XG5cbiAgICAgICAgICAgIGlmKGV2ZS5JZFVzZXJFbXByZXNhKXtcbiAgICAgICAgICAgICAgICBldmVudG8udXNlckVtcHJlc2EuaWRVc2VyRW1wcmVhID0gZXZlLklkVXNlckVtcHJlc2E7XG4gICAgICAgICAgICB9XG5cbiAgICAgICAgICAgIGV2ZW50cy5wdXNoKGV2ZW50byk7XG4gICAgICAgIH0pO1xuXG4gICAgICAgIHJldHVybiBldmVudHM7XG4gICAgfVxuXG4gICAgcHVibGljIHN0YXRpYyBpbmZvRXZlbnRKU09OdG9FdmVudChpbmZvRXZlbnRKU09OKXtcbiAgICAgICAgbGV0IGV2ZW50bzogRXZlbnQgPSBuZXcgRXZlbnQoKTtcblxuICAgICAgICBsZXQgZXZlID0gaW5mb0V2ZW50SlNPTlsnZXZlbnRvJ107XG5cbiAgICAgICAgZXZlbnRvLmlkRXZlbnRvID0gZXZlLklkRXZlbnRvO1xuICAgICAgICBldmVudG8udGl0dWxvID0gZXZlLlRpdHVsbztcbiAgICAgICAgZXZlbnRvLmRlc2NyaXBjaW9uID0gZXZlLkRlc2NyaXBjaW9uO1xuXG4gICAgICAgIGxldCBmZWNoYVNwbGl0ZWFkYSA9IGV2ZS5GZWNoYS5zcGxpdChcIlRcIiwgMSlbMF0uc3BsaXQoXCItXCIsIDMpO1xuICAgICAgICBsZXQgZmVjaGE6IERhdGUgPSAgbmV3IERhdGUoZmVjaGFTcGxpdGVhZGFbMF0sIGZlY2hhU3BsaXRlYWRhWzFdIC0gMSwgZmVjaGFTcGxpdGVhZGFbMl0pO1xuXG4gICAgICAgIGV2ZW50by5mZWNoYSA9IGZlY2hhO1xuXG4gICAgICAgIGxldCBwZXJpb2RvOlBlcmlvZG8gPSBuZXcgUGVyaW9kbygpO1xuICAgICAgICBcbiAgICAgICAgbGV0IGhvcmFzTWludXRvc0VtcGllemEgPSBldmUuRW1waWV6YS5zcGxpdChcIlRcIiwgMilbMV0uc3BsaXQoXCI6XCIsIDIpO1xuICAgICAgICBsZXQgaG9yYXNNaW51dG9zQWNhYmEgPSBldmUuQWNhYmEuc3BsaXQoXCJUXCIsIDIpWzFdLnNwbGl0KFwiOlwiLCAyKTtcblxuICAgICAgICBwZXJpb2RvLmVtcGllemFIb3JhID0gaG9yYXNNaW51dG9zRW1waWV6YVswXTtcbiAgICAgICAgcGVyaW9kby5lbXBpZXphTWludXRvID0gaG9yYXNNaW51dG9zRW1waWV6YVsxXTtcblxuICAgICAgICBwZXJpb2RvLmFjYWJhSG9yYSA9IGhvcmFzTWludXRvc0FjYWJhWzBdO1xuICAgICAgICBwZXJpb2RvLmFjYWJhTWludXRvID0gaG9yYXNNaW51dG9zQWNhYmFbMV07XG5cbiAgICAgICAgZXZlbnRvLnBlcmlvZG8gPSBwZXJpb2RvO1xuXG4gICAgICAgIGV2ZW50by5tb3Rpdm9DYW5jZWxhY2lvbiA9IGV2ZS5Nb3Rpdm9DYW5jZWxhY2lvbjtcblxuICAgICAgICBldmVudG8uZXN0YWRvLmlkRXN0YWRvID0gaW5mb0V2ZW50SlNPTlsnZXN0YWRvJ10uSWRFc3RhZG87XG4gICAgICAgIGV2ZW50by5lc3RhZG8uY29kaWdvID0gaW5mb0V2ZW50SlNPTlsnZXN0YWRvJ10uQ29kaWdvO1xuICAgICAgICBldmVudG8uZXN0YWRvLmRlc2NyaXBjaW9uID0gaW5mb0V2ZW50SlNPTlsnZXN0YWRvJ10uRGVzY3JpcGNpb247XG5cbiAgICAgICAgaWYoaW5mb0V2ZW50SlNPTlsndXNlckVtcHJlc2EnXSl7XG4gICAgICAgICAgICBsZXQgdXNlciA9IGluZm9FdmVudEpTT05bJ3VzZXJFbXByZXNhJ107XG4gICAgICAgICAgICBldmVudG8udXNlckVtcHJlc2EuaWRVc2VyRW1wcmVhID0gdXNlcltcIlVzZXJFbXByZXNhLklkVXNlckVtcHJlc2FcIl07XG4gICAgICAgICAgICBldmVudG8udXNlckVtcHJlc2EuaWRVc2VyID0gdXNlci5JZFVzZXI7XG4gICAgICAgICAgICBldmVudG8udXNlckVtcHJlc2Eubm9tYnJlID0gdXNlci5Ob21icmU7XG4gICAgICAgICAgICBldmVudG8udXNlckVtcHJlc2EuYXBlbGxpZG9zID0gdXNlci5BcGVsbGlkb3M7XG4gICAgICAgICAgICBldmVudG8udXNlckVtcHJlc2EudGVsZWZvbm8gPSB1c2VyLlRlbGVmb25vO1xuICAgICAgICAgICAgZXZlbnRvLnVzZXJFbXByZXNhLmFwZWxsaWRvcyA9IHVzZXIuQXBlbGxpZG9zO1xuICAgICAgICAgICAgZXZlbnRvLnVzZXJFbXByZXNhLmZvdG8gPSB1c2VyLkZvdG87XG4gICAgICAgICAgICBldmVudG8udXNlckVtcHJlc2EuY2F0ZWdvcnkubm9tYnJlID0gdXNlcltcIkNhdGVnb3J5Lm5vbWJyZVwiXTtcbiAgICAgICAgICAgIGV2ZW50by51c2VyRW1wcmVzYS5kaXJlY2Npb25GaWphID0gPGJvb2xlYW4+dXNlcltcIlVzZXJFbXByZXNhLmRyaXJlY2Npb25fZmlqYVwiXTtcbiAgICAgICAgfVxuXG4gICAgICAgIGV2ZW50by5sb2NhdGlvbiA9IGV2ZS5EaXJlY2Npb247XG5cbiAgICAgICAgcmV0dXJuIGV2ZW50bztcbiAgICB9XG59Il19